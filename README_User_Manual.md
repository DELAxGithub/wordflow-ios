# Wordflow アプリケーション 取扱説明書

## 📖 目次
1. [はじめに](#はじめに)
2. [インターフェース説明](#インターフェース説明)
3. [基本操作](#基本操作)
4. [マークダウンエディター](#マークダウンエディター)
5. [ライティングセッション](#ライティングセッション)
6. [エクスポート・インポート](#エクスポートインポート)
7. [検索・フィルター](#検索フィルター)
8. [設定とカスタマイズ](#設定とカスタマイズ)
9. [トラブルシューティング](#トラブルシューティング)
10. [付録](#付録)

---

## はじめに

### アプリケーション概要
Wordflowは、文書作成とワークフロー最適化のためのmacOSアプリケーションです。Markdown、プレーンテキスト、リッチテキストに対応し、執筆活動の生産性向上をサポートします。

### 主要機能
- **文書管理**: 複数形式の文書を効率的に管理
- **プロジェクト管理**: 関連文書をプロジェクトとしてまとめて管理
- **マークダウンエディター**: リアルタイムプレビュー機能付きエディター
- **ライティングセッション追跡**: 執筆活動の分析と生産性監視
- **エクスポート/インポート**: 複数形式での一括処理
- **高度な検索**: 関連度スコア付き検索とフィルタリング
- **DELAX品質管理**: 統合された品質管理システム

### システム要件
- macOS 14.0以降
- SwiftData対応
- 最小ディスク容量: 50MB

---

## インターフェース説明

### メイン画面の構成
Wordflowは3カラムレイアウトを採用しています：

1. **左サイドバー**: ナビゲーション（最小幅200px、理想幅220px）
2. **中央コンテンツリスト**: 選択された項目の一覧（最小幅300px、理想幅350px）
3. **右詳細ビュー**: 選択された項目の詳細（最小幅400px）

### サイドバーセクション

#### Wordflow
- **📄 Documents**: 全ての文書を管理（文書数表示）
- **📁 Projects**: プロジェクトを管理（プロジェクト数表示）

#### Analytics
- **📊 Dashboard**: 分析ダッシュボード
- **🕐 Writing Sessions**: 執筆セッション履歴

#### Settings
- **⚙️ Preferences**: アプリケーション設定

### ツールバー
- **新規作成ボタン**: 文書・プロジェクトの新規作成
- **検索ボタン**: 高度検索機能へのアクセス
- **Export/Importボタン**: 一括エクスポート・インポート機能

---

## 基本操作

### 新しい文書の作成

1. **Documents**セクションを選択
2. ツールバーの**+ボタン**をクリック
3. **New Document**シートが開きます
4. 文書タイトルを入力（空白の場合は"Untitled Document"）
5. 初期コンテンツを入力（オプション）
6. **Save**ボタンをクリック

### 文書の編集

1. 文書リストから編集したい文書を選択
2. 詳細ビューで以下が編集可能：
   - **タイトル**: クリックして直接編集
   - **コンテンツ**: メインエディターエリア
   - **ステータス**: Draft, In Review, Completed, Published, Archived
   - **優先度**: Low, Medium, High, Urgent

### 文書情報の表示
各文書行には以下の情報が表示されます：
- 文書タイトル
- 文字数（"○○ words"）
- コンテンツプレビュー（2行まで）
- ステータス
- 最終更新日時（相対表示）

### 文書の削除
1. 削除したい文書を右クリック
2. コンテキストメニューから**Delete**を選択
3. 確認なしで削除されます

### プロジェクト管理

#### 新しいプロジェクトの作成
1. **Projects**セクションを選択
2. ツールバーの**+ボタン**をクリック
3. プロジェクト名と説明を入力
4. **Save**ボタンをクリック

#### プロジェクト情報
- プロジェクト名
- 進捗率（%表示）
- 説明文
- ステータス
- 締切日（設定されている場合）

---

## マークダウンエディター

### エディターモードの切り替え
マークダウンエディターには3つの表示モードがあります：

1. **📝 エディターモード**: テキスト編集のみ
2. **📱 分割モード**: エディターとプレビューを並列表示
3. **👁 プレビューモード**: プレビューのみ

### フォーマット機能（ツールバー）

#### テキスト装飾
- **B** (Bold): `**テキスト**`
- **I** (Italic): `*テキスト*`
- **~~** (Strikethrough): `~~テキスト~~`

#### リスト
- **•** (箇条書きリスト): `- アイテム`
- **1.** (番号付きリスト): `1. アイテム`

#### その他
- **🔗** (リンク): `[テキスト](URL)`
- **🖼** (画像): `![Alt Text](image.jpg)`
- **"** (引用): `> 引用文`

### プレビュー機能
- リアルタイムでHTMLプレビューを表示
- カスタムCSS適用済み
- 以下の要素をサポート：
  - ヘッダー（H1-H3）
  - 太字・斜体・取り消し線
  - リンク・画像
  - インラインコード
  - 引用ブロック

### エディター設定
- フォント: Monaco（等幅フォント）
- サイズ: 14pt
- 自動改行: 有効
- 縦スクロール: 有効

---

## ライティングセッション

### セッションの開始・終了

#### セッション開始
1. **Writing Sessions**画面を開く
2. **Start Session**ボタンをクリック
3. タイマーが開始されます

#### セッション制御
- **⏸** (一時停止): セッションを一時停止
- **⏹** (終了): セッションを終了
- リアルタイムタイマー表示（HH:MM:SS形式）

### 生産性評価システム
セッション終了時に自動で生産性評価が行われます：

- **🐢 Low**: 0-10 WPM（Words Per Minute）
- **🚶 Medium**: 10-20 WPM
- **🏃 High**: 20-35 WPM
- **⚡ Excellent**: 35+ WPM

### セッション情報の表示
各セッション行には以下が表示されます：
- 生産性アイコンと評価
- 開始日時
- セッション時間（完了時）または"In Progress"
- 執筆文字数
- WPM値（Words Per Minute）
- 進捗円グラフ（500文字目標基準）

### 時間範囲フィルター
- **Today**: 今日のセッション
- **This Week**: 今週のセッション
- **This Month**: 今月のセッション
- **This Year**: 今年のセッション

---

## エクスポート・インポート

### エクスポート機能

#### 対応形式
- **📄 Markdown** (.md): 元の形式を保持
- **📄 Plain Text** (.txt): プレーンテキスト
- **🌐 HTML** (.html): CSS適用済みHTML

#### エクスポート手順
1. メインツールバーの**Export/Import**ボタンをクリック
2. **Export Documents**セクションで以下を設定：
   - エクスポート形式を選択
   - オプション設定：
     - ✅ Include metadata（メタデータを含む）
     - ✅ Create archive（アーカイブを作成）
     - ✅ Include CSS styling（HTMLの場合）
3. 統計情報を確認：
   - 文書数
   - 総文字数
   - 推定ファイルサイズ
4. **Export Documents**ボタンをクリック
5. 進行状況バーで進捗を監視
6. 完了後、保存場所を選択

#### HTMLエクスポート詳細
HTMLエクスポート時には以下のCSS適用済み：
- Apple系フォント使用
- レスポンシブデザイン
- 行間調整（1.6）
- カラーリング（ヘッダー、リンクなど）
- メタデータ表示（作成日、更新日、文字数）

### インポート機能

#### 対応形式
- Text files (.txt)
- Markdown files (.md)
- HTML files (.html)
- RTF files (.rtf)

#### インポート手順
1. **Import Documents**セクションで以下を設定：
   - ✅ Create projects for folders（フォルダをプロジェクトに）
   - ✅ Preserve metadata（メタデータを保持）
   - ✅ Skip duplicates（重複をスキップ）
2. **Select Files to Import**ボタンをクリック
3. ファイルを複数選択可能
4. 進行状況を監視
5. 完了後、統計を確認：
   - インポート数
   - スキップ数
   - エラー数

#### 重複検出
- ファイル名での重複検出
- 重複の場合はスキップ（設定による）

---

## 検索・フィルター

### 基本検索
1. Documents画面でツールバーの**🔍検索**ボタンをクリック
2. 検索窓に検索語を入力
3. 文書タイトル・コンテンツから検索
4. リアルタイム検索結果表示

### 高度なフィルタリング

#### フィルター設定（🎚ボタンをクリック）
- **文書タイプ**: Markdown, Plain Text, Rich Text
- **ステータス**: Draft, In Review, Completed, Published, Archived
- **優先度**: Low, Medium, High, Urgent
- **日付範囲**: Today, This Week, This Month, This Year

#### アクティブフィルター
- 適用中のフィルターがチップ形式で表示
- 個別削除可能（×ボタン）
- **Clear All**で全フィルター解除

### 検索結果

#### 関連度スコア計算
- タイトル一致: +60%
- コンテンツ一致: +40%
- 最近の更新: +20%（30日以内の場合）
- 最大スコア: 100%

#### 結果表示
- 関連度の高い順にソート
- 文書/プロジェクトタイプアイコン
- タイトル・サブタイトル
- コンテンツスニペット（検索語周辺50文字）
- 関連度（%表示）
- 最終更新日時

### 検索状態
- **検索中**: プログレスインジケーター表示
- **結果なし**: 検索条件変更提案
- **プレースホルダー**: 検索機能説明

---

## 設定とカスタマイズ

### 一般設定

#### 自動保存
- **Auto-save documents**: 自動保存の有効/無効
- **Auto-save interval**: 保存間隔（30秒〜5分）

#### テキスト校正
- **Spell checking**: スペルチェック
- **Grammar checking**: 文法チェック

### 執筆設定

#### デフォルト設定
- **Default document type**: 新規文書のデフォルト形式

#### セッション追跡
- **Track writing sessions**: セッション追跡の有効/無効
- **Auto-start sessions**: 自動セッション開始
- **Session timeout**: セッションタイムアウト（2分〜Never）

### エクスポート設定
- **Default export format**: デフォルトエクスポート形式
- **Include metadata in exports**: エクスポート時のメタデータ含有

### 分析設定
- **Enable analytics**: 分析機能の有効/無効
- **Track productivity metrics**: 生産性メトリクス追跡
- **Daily word count goal**: 1日の文字数目標

### 品質管理（DELAX）
- **Enable DELAX quality management**: 品質管理システム
- **Quality threshold**: 品質閾値設定
- **Performance monitoring**: パフォーマンス監視

### 高度な設定
- **Debug mode**: デバッグモード
- **Performance optimizations**: パフォーマンス最適化
- **Cache management**: キャッシュ管理

---

## トラブルシューティング

### よくある問題と解決方法

#### アプリケーションが起動しない
1. macOSのバージョンを確認（14.0以降必要）
2. アプリケーションを完全終了して再起動
3. システム再起動

#### 文書が保存されない
1. **自動保存設定**を確認
2. ディスク容量を確認
3. ファイルアクセス権限を確認

#### マークダウンプレビューが表示されない
1. 文書タイプが**Markdown**に設定されているか確認
2. エディターモードを分割モードまたはプレビューモードに変更
3. アプリケーション再起動

#### セッションが記録されない
1. **Settings** > **Writing** > **Track writing sessions**が有効か確認
2. セッションを手動で終了しているか確認
3. アプリケーションデータのリセット

#### エクスポートが失敗する
1. 選択した文書数を確認
2. ディスク容量を確認
3. ファイルアクセス権限を確認
4. より小さな単位でエクスポートを試行

### エラーハンドリング
Wordflowには包括的なエラーハンドリングシステムが組み込まれています：

- **WordflowError**：アプリケーション固有のエラー
- **エラーダイアログ**：ユーザーフレンドリーなエラー表示
- **自動リカバリー**：可能な場合の自動復旧
- **ログ記録**：デバッグ用の詳細ログ

### パフォーマンス最適化

#### メモリ使用量削減
1. 未使用の文書・プロジェクトを削除
2. セッション履歴の定期的な削除
3. キャッシュのクリア

#### 応答性の向上
1. 大きなファイルの分割
2. 自動保存間隔の調整
3. 分析機能の一時無効化

---

## 付録

### キーボードショートカット

#### 一般
- `⌘+N`: 新規文書
- `⌘+S`: 保存
- `⌘+W`: ウィンドウを閉じる
- `⌘+Q`: アプリケーション終了

#### エクスポート・インポート
- `⌘+E`: エクスポート・インポート画面を開く
- `⎋` (Escape): 操作のキャンセル
- `⌘+.`: 操作の停止

#### マークダウンエディター
- `⌘+B`: 太字
- `⌘+I`: 斜体
- `⌘+⇧+S`: 取り消し線

### ファイル形式対応表

| 形式 | 拡張子 | 読み込み | 書き出し | プレビュー |
|------|--------|----------|----------|------------|
| Markdown | .md | ✅ | ✅ | ✅ |
| Plain Text | .txt | ✅ | ✅ | ❌ |
| Rich Text | .rtf | ✅ | ✅ | ❌ |
| HTML | .html | ✅ | ✅ | ✅ |

### 色コード設定

#### 優先度カラー
- **Low**: #34C759 (緑)
- **Medium**: #007AFF (青)
- **High**: #FF9500 (オレンジ)
- **Urgent**: #FF3B30 (赤)

#### 生産性カラー
- **Low**: #FF3B30 (赤)
- **Medium**: #FF9500 (オレンジ)
- **High**: #34C759 (緑)
- **Excellent**: #007AFF (青)

### システム統合

#### SwiftData統合
- 自動データ永続化
- リレーションシップ管理
- マイグレーション対応

#### macOS統合
- ネイティブファイルピッカー
- システムカラー対応
- ダークモード対応
- アクセシビリティ機能

### パフォーマンス指標

#### 推奨仕様
- RAM: 4GB以上
- ストレージ: 1GB以上の空き容量
- CPU: Apple Silicon または Intel (x64)

#### 制限事項
- 同時編集可能文書数: 制限なし（メモリ依存）
- 最大ファイルサイズ: 100MB
- セッション履歴保存期間: 1年

---

**Wordflow v1.0**  
© 2025 Wordflow Development Team

*本マニュアルは実際のソースコード分析に基づいて作成されており、アプリケーションの動作を正確に反映しています。*